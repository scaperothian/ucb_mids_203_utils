---
title: "HW9"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
L_orig = 11.5+  2 * w + 1.5 * c - 1.2 * o +  0 * h
L_new  = B0  + B1 * w +  B2 * c +   0 * o + B3 * h

# Solving for different versions of L_new...
# B_0 is 10.3, B_1 is 2,  L_orig = 11.5 - 1.2
L_new (o=1) = 10.3 + 2 * w + 2.7 * 0 + 0 * 1 + 1.2 * 0    

# B_3 is 1.2, L_orig = 11.5
L_new (h=1) = 10.3 + 2 * w + 2.7 * 0 + 0 * 0 + 1.2 * 1 # o = 0, c = 0

# B_2 is 2.7.  L_orig = 11.5 + 1.5
L_new (c=1) = 10.3 + 2 * w + 2.7 * 1 + 0 * 0 + 1.2 * 0 # o = 0, h = 0
```

```{r cars}
rmystery <- function(n){
  x = runif(n)
  y = runif(n, min=0, max = 1/x)
  data.frame(x=x,y=y)
}
#plot(rmystery(100))

data <- rmystery(100)

plt <- data %>%
  ggplot()+
  aes(x=x,y=y)+
  geom_point()+
  scale_x_continuous(limits = c(0, 1.1)) +
  scale_y_continuous(limits = c(0, 8))
plt
```

## Including Plots

You can also embed plots, for example:

```{r}
# draw 100 datapoints from the mystery distribution above, fits a regression of y on x, then returns the slope coefficient.

# Run your experiment function 1000 times and plot a histogram of your result

experiment <- function() {
data <- rmystery(100)
model <- lm(y~x,data=data)
model$coefficients[2] #slope coefficient
}

Beta1 <- replicate(1000,experiment())
Beta1_hist <- data.frame(z=Beta1)
h <- Beta1_hist %>%  
  ggplot() + 
  aes(z) +
  geom_histogram(fill = "red", color = "white", bins = 50) +
  ggtitle("Histogram of slope for Q2.1 rmystery")+
  labs(x = "N", y="Count")+
  scale_x_continuous(limits = c(-50,0))+
  scale_y_continuous(limits = c(0,100))
h
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
renigma <- function(n){
  x = runif(n)
  y = runif(n, min=0, max = (1-x)^2)
  data.frame(x=x,y=y)
}
plot(renigma(100))

```

```{r}
# draw 100 datapoints from the mystery distribution above, fits a regression of y on x, then returns the slope coefficient.

# Run your experiment function 1000 times and plot a histogram of your result

experiment_m <- function() {
data <- renigma(100)
model <- lm(y~x,data=data)
model$coefficients[2] #slope coefficient
}

Beta1 <- replicate(1000,experiment_m())
Beta1_hist <- data.frame(z=Beta1)
h <- Beta1_hist %>%  
  ggplot() + 
  aes(z) +
  geom_histogram(fill = "red", color = "white", bins = 50) +
  ggtitle("Histogram of slope for Q2.1 rmystery")+
  labs(x = "N", y="Count")
h

```

```{r}
## install the package if it's not installed
install.packages("remotes")
remotes::install_github("baumer-lab/fec16")
   
library(fec16)
```

```{r}

```
